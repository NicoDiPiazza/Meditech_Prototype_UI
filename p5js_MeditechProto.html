<!DOCTYPE html>
<html> 
  <head>
    <title>Processing.JS inside Webpages: Template</title> 
  </head>
  <body>
	<!--This draws the canvas on the webpage -->
    <canvas id="mycanvas"></canvas> 
	<audio id="audio" src="ring-G.mp3"></audio>
  </body>
 
  <!-- Include the processing.js library -->
  <!-- See https://khanacademy.zendesk.com/hc/en-us/articles/202260404-What-parts-of-ProcessingJS-does-Khan-Academy-support- for differences -->
  <script src="https://cdn.jsdelivr.net/processing.js/1.4.8/processing.min.js"></script> 
  <script>




  var programCode = function(processingInstance) {
    with (processingInstance) {

	
	var screenWidth = 1400;
	var screenHeight = 600;
	
      size(screenWidth, screenHeight); 
      frameRate(30);
        
      // Paste code from Khan Academy here:


	var buttonDimensions = function(givenPage){
		//takes a list of buttons from the given page and says where each one goes
		// butts used to be a shortening of buttons so that I wasn't initializing a variable twice... but now it's just for fun.
		let butts = [];
		let currentAddress = 0;
		for(j = 0; j < givenPage.Buttons.length; j++){
			NButtons = givenPage.Buttons[j][0];
			collectionX = givenPage.Buttons[j][1];
			collectionY = givenPage.Buttons[j][2];
			collectionWidth = givenPage.Buttons[j][3];
			collectionHeight = givenPage.Buttons[j][4];
			horizontal = givenPage.Buttons[j][5];

			if(horizontal == true){
				for(i = 0; i < NButtons; i++){					
					newButton = new Button(givenPage.Addresses[currentAddress], collectionX + (collectionWidth*i/NButtons) + spread/2, 
						collectionY, (collectionWidth/NButtons) - spread, 
						collectionHeight, myDarkBlue);
					butts.push(newButton);
					currentAddress++;
				};
			}
			else{
				for(i = 0; i < NButtons; i++){		
					newButton = new Button(givenPage.Addresses[currentAddress], collectionX, 
						collectionY + (collectionHeight*i/NButtons) + spread/2, (collectionWidth), 
						(collectionHeight/NButtons) - spread, myDarkBlue);
					butts.push(newButton);
					currentAddress++;
				};
			}
		}	
		return butts;
	};

	var pageDisplay = function(givenPage){

		buttDims = buttonDimensions(currentPage);

		for (i = 0; i < buttDims.length; i++){
			let color = buttDims[i].color;
			fill(color[0], color[1], color[2]);
			rect(buttDims[i].x, buttDims[i].y, buttDims[i].width, buttDims[i].height);
		};

	}

	var mousePressed = function(){
		// anything you want to happen on a mouse click goes in here. I don't like this function.

		background(myLightBlue[0], myLightBlue[1], myLightBlue[2]);

		let hitboxes = buttonDimensions(currentPage);

		let NChecks = 0;
		for(i = 0; i< currentPage.Buttons.length; i++){
			NChecks = NChecks + currentPage.Buttons[i][0];

		};

		for (i = 0; i < hitboxes.length; i++){
			if(hitboxes[i].x <= mouseX && mouseX <= hitboxes[i].x + hitboxes[i].width){
				if(hitboxes[i].y <= mouseY && mouseY <= hitboxes[i].y + hitboxes[i].height){

					currentPage = pages[hitboxes[i].page];
					// put all the feedback stuff here
					myAudio.play()
					wait = 0;
					break; // this has to go in otherwise the for loop gets REAL confused about what the current page is
				};
			};
		};

		background(myLightBlue[0], myLightBlue[1], myLightBlue[2]);
		
		pageDisplay(currentPage);

	}


	class Button{
		constructor(page, x, y, width, height, color) {
		this.page = page;
		this.x = x;
		this.y = y;
		this.width = width;
		this.height = height;
		this.color = color;
  		}	
	};


	class Page{
		constructor(name, Buttons, Addresses){
			this.name = name;
			this.Buttons = Buttons;
			this.Addresses = Addresses;


		}

	};

	  

	var spread = 50;
	let myAudio = document.querySelector('#audio')
	let wait =0;
	let hangTime = 10;
	let cursorRadius = 50
	

	// hardcode pages here until pages are procedurally generated
	//button set syntax: [[NButtons, x, y, width, height, orientation], [ditto], ...]
	let home = new Page("home", [[2, 0, 0, 1000, 200, true], [3, 200, 100, 400, 400, false]], [0, 1, 2, 3, 4]);
	let pageA = new Page ('A', [[1, 0, 0, 800, 200, true]], [0, 1, 2, 3, 4]);
	let pageB = new Page ('B', [[2, 300, 0, 800, 200, true]], [0, 1, 2, 3, 4]);
	let pageC = new Page ('C', [[3, 1000, 50, 400, 200, true]], [0, 1, 2, 3, 4]);
	let pageD = new Page ('D', [[4, 0, 0, 1200, 200, true]], [0, 1, 2, 3, 4]);
	//let pageExample = new Page ('Example', [5, ])
	let pages = [home, pageA, pageB, pageC, pageD];

	


	let currentPage = pages[0];

	// color pallette
	var myVeryLightBlue = [224, 230, 254];
	var myLightBlue = [180, 191, 255];
	var myDarkBlue = [103, 119, 204];
	var myLightGreen = [180, 254, 166];
	var myRed = [171, 88, 98];



	draw = function(){

		background(myLightBlue[0], myLightBlue[1], myLightBlue[2]);

		pageDisplay(currentPage);
		fill()

		fill(255, 255, 255);
		
		if(wait<=hangTime){	
			fill(myLightGreen[0], myLightGreen[1], myLightGreen[2]);
			
			wait++;
		}
		ellipse(mouseX, mouseY, 50, 50);
		
	
		console.log(currentPage.name);


	}
	  
	  
	    

	  
	  
	  
    }};


  // Get the canvas that ProcessingJS will use
  var canvas = document.getElementById("mycanvas"); 
  // Pass the function to ProcessingJS constructor
  var processingInstance = new Processing(canvas, programCode); 

  </script>
</html>
