<!DOCTYPE html>
<html> 
  <head>
    <title>Processing.JS inside Webpages: Template</title> 
  </head>
  <body>
	<!--This draws the canvas on the webpage -->
    <canvas id="mycanvas"></canvas> 
	<audio id="audio" src="ring-G.mp3"></audio>
  </body>
 
  <!-- Include the processing.js library -->
  <!-- See https://khanacademy.zendesk.com/hc/en-us/articles/202260404-What-parts-of-ProcessingJS-does-Khan-Academy-support- for differences -->
  <script src="https://cdn.jsdelivr.net/processing.js/1.4.8/processing.min.js"></script> 
  <script>




  var programCode = function(processingInstance) {
    with (processingInstance) {

	
	var width = 1500;
	var height = 700;
	
      size(width, height); 
      frameRate(30);
        
      // Paste code from Khan Academy here:


	var buttonDimensions = function(givenPage){
		NButtons = givenPage.NButtons;
		// butts used to be a shortening of buttons so that I wasn't initializing a variable twice... but now it's just for fun.
		let butts = [];
		for(i = 0; i < NButtons; i++){
		newButton = new Button(i, (width/NButtons)*i + spread/2, (height/3), (width/NButtons - spread), height/3, myRed);
		butts.push(newButton)


		};

		return butts;
	};

	var pageDisplay = function(givenPage, buttons){

		NButtons = givenPage.NButtons;

		for (i = 0; i < NButtons; i++){
			let color = buttons[i].color;
			fill(color[0], color[1], color[2]);
			rect(buttons[i].x, buttons[i].y, buttons[i].width, buttons[i].height);
		};

	}

	var mousePressed = function(){
		// anything you want to happen on a mouse click goes in here. I don't like this function.

		background(myLightBlue[0], myLightBlue[1], myLightBlue[2]);

		let hitboxes = buttonDimensions(currentPage);

		for (i = 0; i < currentPage.NButtons; i++){
			if(hitboxes[i].x <= mouseX && mouseX <= hitboxes[i].x + hitboxes[i].width){
				if(hitboxes[i].y <= mouseY && mouseY <= hitboxes[i].y + hitboxes[i].height){

					currentPage = pages[hitboxes[i].page];
					// put all the feedback stuff here
					myAudio.play()
					break; // this has to go in otherwise the for loop gets REAL confused about what the current page is
				};
			};
		};

		background(myLightBlue[0], myLightBlue[1], myLightBlue[2]);
		wait = 0;
		
		hitboxes = buttonDimensions(currentPage);
		pageDisplay(currentPage, hitboxes);

	}


	class Button{
		constructor(page, x, y, width, height, color) {
		this.page = page;
		this.x = x;
		this.y = y;
		this.width = width;
		this.height = height;
		this.color = color;
  		}	
	};


	class Page{
		constructor(name, NButtons){
			this.name = name;
			this.NButtons = NButtons;

		}

	};

	  
	var i = 0;
	var x = 200;
	var y = 200;
	var xVel = 9;
	var yVel = -7;
	var spread = 50;
	let myAudio = document.querySelector('#audio')
	let checkSize = 50;
	let wait =0;
	let hangTime = 20;
	

	// hardcode pages here until pages are procedurally generated
	let home = new Page("home", 5);
	let pageA = new Page ('A', 1);
	let pageB = new Page ('B', 2);
	let pageC = new Page ('C', 3);
	let pageD = new Page ('D', 4);
	let pages = [home, pageA, pageB, pageC, pageD];


	let currentPage = pages[0];

	// color pallette
	var myVeryLightBlue = [224, 230, 254];
	var myLightBlue = [180, 191, 255];
	var myDarkBlue = [103, 119, 204];
	var myLightGreen = [180, 254, 166];
	var myRed = [171, 88, 98];



	draw = function(){
		
		if(wait<=hangTime){	
			noStroke();
			fill(myLightGreen[0], myLightGreen[1], myLightGreen[2]);
	
			triangle(width-2.5*checkSize, 1.6*checkSize, width-2*checkSize, 2*checkSize, width-2*checkSize, 3*checkSize);
			triangle(width-1*checkSize, 0.5*checkSize, width-2*checkSize, 2*checkSize, width-2*checkSize, 3*checkSize);
	
			stroke(10);
			if(wait === hangTime){
				background(myLightBlue[0], myLightBlue[1], myLightBlue[2]);
				hitboxes = buttonDimensions(currentPage);
				pageDisplay(currentPage, hitboxes);
			};
		}
		wait++;
		
		
	
		console.log(currentPage.name);

	}

	  
	  
	  
    }};


  // Get the canvas that ProcessingJS will use
  var canvas = document.getElementById("mycanvas"); 
  // Pass the function to ProcessingJS constructor
  var processingInstance = new Processing(canvas, programCode); 

  </script>
</html>
